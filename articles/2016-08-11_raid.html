<!DOCTYPE html><html lang="fa"><head><link rel="manifest" href="/manifest.json"/><link rel="apple-touch-icon" href="/icon-512x512.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link href="//db.onlinewebfonts.com/c/14b4bf4df4455e6a1277f2b2584dadd6?family=BBCNassim" rel="stylesheet" type="text/css"/><meta name="msapplication-TileColor" content="#ce1919"/><meta name="theme-color" content="#ce1919"/><meta charSet="utf-8"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@site"/><meta name="twitter:creator" content="@handle"/><meta property="og:type" content="website"/><meta property="og:locale" content="fa_IR"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>راه اندازی RAID در لینوکس</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="آموزش راه اندازی RAID در لینوکس"/><meta property="og:url" content="/articles/[slug]"/><meta property="og:title" content="راه اندازی RAID در لینوکس"/><meta property="og:description" content="آموزش راه اندازی RAID در لینوکس"/><meta property="og:image" content="https://linuxiha.com/images/linux-raid.jpeg"/><meta property="og:image:alt" content="راه اندازی RAID در لینوکس"/><meta property="og:image:width" content="800"/><meta property="og:image:height" content="600"/><meta property="og:site_name" content="Linuxiha"/><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://linuxiha.com/articles/2016-08-11_raid"
    },
    "headline": "راه اندازی RAID در لینوکس",
    "image": [
      "https://linuxiha.com/images/linux-raid.jpeg"
     ],
    "datePublished": "Thu Aug 11 2016 00:00:00 GMT+0000",
    "dateModified": "Thu Aug 11 2016 00:00:00 GMT+0000",
    "author": {"@type": "Person","name": "رضا معصوم‌وند"},
    "publisher": {
      "@type": "Organization",
      "name": "Linuxiha",
      "logo": {
        "@type": "ImageObject",
        "url": "https://linuxiha.com/images/logo.png"
      }
    },
    "description": "آموزش راه اندازی RAID در لینوکس"
  }</script><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https://linuxiha.com",
          "name": "لینوکسی ها"
        }
      },{
        "@type": "ListItem",
        "position": 2,
        "item": {
          "@id": "/learning",
          "name": "آموزشی"
        }
      },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https://linuxiha.com/articles/2016-08-11_raid",
          "name": "راه اندازی RAID در لینوکس"
        }
      }
     ]
  }</script><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/css/be235685d546691402be.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be235685d546691402be.css" data-n-g=""/><link rel="preload" href="/_next/static/css/d4b1ad855d90d489a111.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d4b1ad855d90d489a111.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.f8bd46fc02868c500bda.js" as="script"/><link rel="preload" href="/_next/static/chunks/dccdaae97238514e0e59f68ff40a3150f2d60869.fd7c33e9ae3c66b740c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-3c19994afb449613f52a.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18007ee4e366b206423f37b43f40d4861448257.6ad75590f65d0a64ea61.js" as="script"/><link rel="preload" href="/_next/static/chunks/9f32a1895f4aacf1ea63ff9f71a540b7eb71f721.c3d97f18e04e41235ad9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-5e768503c47f0f474cf1.js" as="script"/><link rel="preload" href="/_next/static/chunks/884c0b09aaba7d8da8976f96bae68463b81d3e33.69e17f26dc467dcd1735.js" as="script"/><link rel="preload" href="/_next/static/chunks/755b54d753eea6c310ec0b9a05508d467366a08f.dd8ff6ba50741b700375.js" as="script"/><link rel="preload" href="/_next/static/chunks/6b20a07b2d70cfcb2a9bc7e0210d4109f26bcd0c.6ef66b02a65441044c74.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/articles/%5Bslug%5D-8dd97a7322e8b3511971.js" as="script"/></head><body dir="rtl" lang="fa"><div id="__next"><header class="header_container__2boq4"><h2></h2><nav class="header_navbar__3Tbm7"><a href="/">خانه</a><a href="/news">خبری</a><a href="/learning">آموزشی</a><a href="/about">درباره ما</a></nav><figure class="header_logo__ZHkcG"><img src="/images/logo.png" alt="linuxiha-logo"/></figure></header><div class="MuiPaper-root article_article__15ETi MuiPaper-elevation1 MuiPaper-rounded"><img src="/images/linux-raid.jpeg" alt="راه اندازی RAID در لینوکس"/><h1>راه اندازی RAID در لینوکس</h1><div class="MuiCardHeader-root"><div class="MuiCardHeader-avatar"><div class="MuiAvatar-root MuiAvatar-circle article_avatar__2QXuX" aria-label="article"><img alt="رضا معصوم‌وند" src="authors/user.png" class="MuiAvatar-img"/></div></div><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-body2 MuiTypography-displayBlock">رضا معصوم‌وند</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-displayBlock">۴ سال قبل - زمان خواندن ۵ دقیقه</span></div></div><section class="article_content__1mHP3"><p>RAID مخفف Redundant Array of Independent Disks مکانیزمی است که در آن مجموعه‌ای از دیسک‌ها به‌صورت زنجیره‌ای به هم متصل می‌شوند و موجب افزایش کارایی و دسترسی‌پذیری به داده‌ها و همچنین تحمل خطاپذیری و بازیابی داده‌های ذخیره شده می‌شود.</p>
<h2>انواع RAID</h2>
<ul>
<li>Hardware RAID: که به‌صورت سخت‌افزاری و مستقل از سیستم‌عامل عمل می‌کند و تمامی عملیات توسط RAID Controller سیستم انجام می‌شود.</li>
<li>Software RAID: که توسط سیستم‌عامل و نرم‌افزار پیکربندی و کنترل می‌شود.</li>
</ul>
<h2>سطوح RIAD</h2>
<p>RAID می‌تواند به‌صورت‌های مختلفی پیاده‌سازی شود که در ادامه به معرفی کاربردی‌ترین آن‌ها می‌پردازیم.</p>
<ul>
<li>
<p>RAID 0 یا Striping: در این روش داده‌ها به‌صورت تکه‌تکه شده و هر تکه در یک دیسک ذخیره می‌شود که موجب افزایش سرعت خواندن/نوشتن می گردد. در این روش امکان تحمل خطاپذیری و بازیابی داده‌ها وجود ندارد و در صورت خرابی یکی از دیسک ها داده‌ها از بین خواهد رفت.</p>
</li>
<li>
<p>RAID 1 یا Mirroring: در این روش داده‌های نوشته شده روی یک دیسک عیناً روی دیسک دیگر کپی می‌شود. در این روش سرعت خواندن/نوشتن افزایش نمی‌یابد ولی امکان تحمل خطاپذیری و بازیابی داده‌ها در زمانی خرابی یکی از دیسک‌ها وجود دارد.</p>
</li>
<li>
<p>RAID 5 یا Striped with Parity: در این روش داده‌ها همانند روش Striping به‌صورت تکه‌تکه شده بین دیسک‌ها تقسیم و ذخیره می‌شود با این تفاوت که علاوه بر داده‌های ذخیره شده نوعی داده تحت عنوان Parity نیز در دیسک‌ها ذخیره می‌گردد. در این روش سرعت خواندن/نوشتن افزایش می‌یابد و همچنین بدلیل استفاده از Parity امکان تحمل خطاپذیری و بازیابی داده‌ها در زمان خرابی یکی از دیسک‌ها وجود دارد.</p>
</li>
<li>
<p>RAID 6 یا Striped with Double Parity: این روش در‌واقع نسخه توسعه یافته RAID 5 می‌باشد با این‌ تفاوت که در این روش از دو بلوک مجزا Parity استفاده می‌شود که موجب می‌شود امکان تحمل خطاپذیری و بازیابی داده‌ها افزایش یابد.</p>
</li>
</ul>
<p>در این آموزش به نصب و راه‌اندازی RAID نرم‌افزاری در لینوکس خواهیم پرداخت.</p>
<h2>نصب و راه‌اندازی RIAD در لینوکس</h2>
<p>ابتدا می‌بایست نرم‌افزار mdadm را نصب کنیم.</p>
<p>برای سیستم‌های مبتنی بر دبیان:</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>sudo apt install mdadm</span></code></pre></pre>
<p>برای سیستم‌های مبتنی بر ردهت:</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>sudo yum install mdadm</span></code></pre></pre>
<p>برای ایجاد یک Raid Array به‌صورت زیر عمل می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm [mode] &lt;raiddevice&gt; [options] &lt;component-devices&gt;</span></code></pre></pre>
<p>دستور mdadm شامل تعدادی گزینه است که در ادامه به توضییح مهمترین آن‌ها می‌پردازیم.</p>
<p><strong>mode:</strong> حالت عملیاتی را مشخص می‌کند و می‌تواند یکی از گزینه های زیر باشد.</p>
<ul>
<li>
<p>C- یا create--: یک array جدید ایجاد می‌کند</p>
</li>
<li>
<p>A- یا assemble--: اجزای یک array از پیش ساخته را به هم ملحق می‌کند.</p>
</li>
<li>
<p>‌B- یا build--: یک array قدیمی بدون superblock ایجاد می‌کند.</p>
</li>
<li>
<p>F- یا follow , --monitor--: برای مانیتور کردن یک یا چند array استفاده می‌شود.</p>
</li>
<li>
<p>G- یا grow--: اندازه یک array فعال را تغییر می‌دهد</p>
</li>
<li>
<p>manage--: برای انجام کارهایی چون اضافه نمودن دیسک جدید و یا حدف نمودن دیسک های معیوب از array به‌کار می‌رود.</p>
</li>
<li>
<p>raiddevice: محل و نام Array را مشخص می‌کند. برای مثال dev/md0/</p>
</li>
</ul>
<p><strong>options:</strong> می‌تواند گزینه‌های زیر را شامل شود.</p>
<ul>
<li>n- یا =raid-devices--: تعداد دیسک های فعال در array را مشخص می‌کند.</li>
<li>x- یا =spare-devices--: تعداد دیسک های یدک را مشخص می‌کند.</li>
<li>l- یا =level--: سطح RAID را مشخص می‌کند</li>
<li>s- یا scan--: فایل کانفیگ یا فایل proc/mdstat/ را برای یافتن اطلاعات مربوط جستجو می‌کند.</li>
<li>e- یا =metadata--: مدل metadata استفاده شده برای array را مشخص می‌کند. مقدار پیشفرض 1.2 می‌باشد</li>
<li>v- یا verbose—:‌ جهت نمایش اطلاعات بیشتر در رابطه با عملیات در حال انجام استفاده می‌شود.</li>
</ul>
<p>و …</p>
<p>mdadm دارای گزینه‌های بسیاری است که می‌توانید جهت مطالعه آن‌ها به مستندات Man Pages این برنامه مراجعه کنید</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>man mdadm</span></code></pre></pre>
<p>برای ایجاد یک array از نوع raid 1 به‌صورت زیر عمل می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm –create /dev/md0 –level=1 –raid-devices=2 /dev/sda /dev/sdb –spare-devices=1 /dev/sdc</span></code></pre></pre>
<p>در اینجا ما یک array از نوع raid 1 یا mirroring با دو دیسک به نام‌های sda و sdb ایجاد نمودیم؛ همچنین یک دیسک sdc را هم به‌عنوان دیسک یدک برای مواقعی که یکی از دیسک های فعال دچار مشکل شد به array اضافه نمودیم.</p>
<p>برای مشاهده وضعیت array ایجاد شده دستور زیر را وارد می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm –detail /dev/md0</span></code></pre></pre>
<p>پس از اجرای دستور فوق خروجی زیر را خواهیم داشت.</p>
<pre><code></code></pre>
<p><strong>نکته: می‌توانیم به‌جای وارد نمودن شماره سطح از عنوان سطح مورد نظر برای گزینه level-- استفاده کنیم.</strong></p>
<p>برای مثال دستور زیر یک array از نوع raid 0 یا stripe ایجاد می‌کند.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm –create /dev/md0 –level=stripe –raid-devices=2 /dev/sda /dev/sdb</span></code></pre></pre>
<p>برای ذخیره تنظیمات به‌صورت زیر عمل می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm –detail –scan /etc/mdadm/mdadm.conf</span></code></pre></pre>
<p>جهت مشاهده وضعیت array ایجاد شده دستور زیر را وارد
می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>cat /proc/mdstat</span></code></pre></pre>
<p>که در صورت فعال بودن و تعریف نمودن array خروجی زیر را خواهیم داشت.</p>
<pre><code></code></pre>
<p>سپس می‌توانیم array ایجاد شده را با فرمت فایل سیستم مورد نظرمان توسط دستور mkfs به‌صورت زیر فرمت کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mkfs -t ext4 /dev/md0</span></code></pre></pre>
<p>و در نهایت array ایجاد شده را ماونت می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mount /dev/md0 /mnt</span></code></pre></pre>
<p>در صورتی که بخواهیم array مورد نظر را غیرفعال کنیم دستور زیر را وارد می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm –stop /dev/md0</span></code></pre></pre>
<p>که در اینجا md0 غیرفعال گردید و برای فعال نمودن مجدد array به صورت زیر عمل می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm –assemble –scan</span></code></pre></pre>
<p>برای حدف یک دیسک از array بصورت زیر عمل می‌کنیم.</p>
<p>ابتدا توسط دستور زیر دیسک را به حالت fail تغییر وضعیت می‌دهیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm /dev/md0 –fail /dev/sdc</span></code></pre></pre>
<p>سپس دستور زیر را برای حذف دیسک از array وارد می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm /dev/md0 –remove /dev/sdc</span></code></pre></pre>
<p>و برای اضافه نمودن مجدد یک دیسک به array دستور زیر را وارد می‌کنیم.</p>
<pre><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-sh" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mdadm /dev/md0 –add /dev/sdc</span></code></pre></pre></section><div class="progress_root__2VpcX"><div class="MuiLinearProgress-root MuiLinearProgress-colorPrimary MuiLinearProgress-determinate" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><div class="MuiLinearProgress-bar MuiLinearProgress-barColorPrimary MuiLinearProgress-bar1Determinate" style="transform:translateX(100%)"></div></div></div></div><nav id="navbar" class="menu_menu-container__3W1os"><a class="menu_menu-item__2FGZV" href="/"><img src="/icons/home.png" alt="home"/> <span>خانه</span> <aside></aside></a><a class="menu_menu-item__2FGZV" href="/news"><img src="/icons/news.png" alt="news"/> <span>خبری</span> <aside></aside></a><a class="menu_menu-item__2FGZV" href="/learning"><img src="/icons/article.png" alt="article"/> <span>آموزشی</span> <aside></aside></a><a class="menu_menu-item__2FGZV" href="/about"><img src="/icons/info.png" alt="info"/> <span>درباره ما</span> <aside></aside></a></nav></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"page":{"slug":"2016-08-11_raid","layout":"post","jdate":"Thu Aug 11 2016 00:00:00 GMT+0000","user":"rmasoumvand","title":"راه اندازی RAID در لینوکس","categories":["آموزشی"],"tags":["پیکربندی"],"featured":"linux-raid.jpeg","keywords":["raid در لینوکس","linux raid","mdadm raid","linux mdadm raid"],"description":"آموزش راه اندازی RAID در لینوکس","timeToRead":5,"content":"\nRAID مخفف Redundant Array of Independent Disks مکانیزمی است که در آن مجموعه‌ای از دیسک‌ها به‌صورت زنجیره‌ای به هم متصل می‌شوند و موجب افزایش کارایی و دسترسی‌پذیری به داده‌ها و همچنین تحمل خطاپذیری و بازیابی داده‌های ذخیره شده می‌شود.\n\n## انواع RAID\n\n*   Hardware RAID: که به‌صورت سخت‌افزاری و مستقل از سیستم‌عامل عمل می‌کند و تمامی عملیات توسط RAID Controller سیستم انجام می‌شود.\n*   Software RAID: که توسط سیستم‌عامل و نرم‌افزار پیکربندی و کنترل می‌شود.\n\n## سطوح RIAD\n\nRAID می‌تواند به‌صورت‌های مختلفی پیاده‌سازی شود که در ادامه به معرفی کاربردی‌ترین آن‌ها می‌پردازیم.\n\n*   RAID 0 یا Striping: در این روش داده‌ها به‌صورت تکه‌تکه شده و هر تکه در یک دیسک ذخیره می‌شود که موجب افزایش سرعت خواندن/نوشتن می گردد. در این روش امکان تحمل خطاپذیری و بازیابی داده‌ها وجود ندارد و در صورت خرابی یکی از دیسک ها داده‌ها از بین خواهد رفت.\n\n*   RAID 1 یا Mirroring: در این روش داده‌های نوشته شده روی یک دیسک عیناً روی دیسک دیگر کپی می‌شود. در این روش سرعت خواندن/نوشتن افزایش نمی‌یابد ولی امکان تحمل خطاپذیری و بازیابی داده‌ها در زمانی خرابی یکی از دیسک‌ها وجود دارد.\n\n*   RAID 5 یا Striped with Parity: در این روش داده‌ها همانند روش Striping به‌صورت تکه‌تکه شده بین دیسک‌ها تقسیم و ذخیره می‌شود با این تفاوت که علاوه بر داده‌های ذخیره شده نوعی داده تحت عنوان Parity نیز در دیسک‌ها ذخیره می‌گردد. در این روش سرعت خواندن/نوشتن افزایش می‌یابد و همچنین بدلیل استفاده از Parity امکان تحمل خطاپذیری و بازیابی داده‌ها در زمان خرابی یکی از دیسک‌ها وجود دارد.\n\n*   RAID 6 یا Striped with Double Parity: این روش در‌واقع نسخه توسعه یافته RAID 5 می‌باشد با این‌ تفاوت که در این روش از دو بلوک مجزا Parity استفاده می‌شود که موجب می‌شود امکان تحمل خطاپذیری و بازیابی داده‌ها افزایش یابد.\n\nدر این آموزش به نصب و راه‌اندازی RAID نرم‌افزاری در لینوکس خواهیم پرداخت.\n\n## نصب و راه‌اندازی RIAD در لینوکس\n\nابتدا می‌بایست نرم‌افزار mdadm را نصب کنیم.\n\nبرای سیستم‌های مبتنی بر دبیان:\n\n```sh\nsudo apt install mdadm\n```\n\nبرای سیستم‌های مبتنی بر ردهت:\n\n```sh\nsudo yum install mdadm\n```\n\nبرای ایجاد یک Raid Array به‌صورت زیر عمل می‌کنیم.\n\n```sh\nmdadm [mode] \u003craiddevice\u003e [options] \u003ccomponent-devices\u003e\n```\n\nدستور mdadm شامل تعدادی گزینه است که در ادامه به توضییح مهمترین آن‌ها می‌پردازیم.\n\n**mode:** حالت عملیاتی را مشخص می‌کند و می‌تواند یکی از گزینه های زیر باشد.\n\n*   C- یا create--: یک array جدید ایجاد می‌کند\n*   A- یا assemble--: اجزای یک array از پیش ساخته را به هم ملحق می‌کند.\n*   ‌B- یا build--: یک array قدیمی بدون superblock ایجاد می‌کند.\n*   F- یا follow , --monitor--: برای مانیتور کردن یک یا چند array استفاده می‌شود.\n*   G- یا grow--: اندازه یک array فعال را تغییر می‌دهد\n*   manage--: برای انجام کارهایی چون اضافه نمودن دیسک جدید و یا حدف نمودن دیسک های معیوب از array به‌کار می‌رود.\n\n*   raiddevice: محل و نام Array را مشخص می‌کند. برای مثال dev/md0/\n\n**options:** می‌تواند گزینه‌های زیر را شامل شود.\n\n*   n- یا =raid-devices--: تعداد دیسک های فعال در array را مشخص می‌کند.\n*   x- یا =spare-devices--: تعداد دیسک های یدک را مشخص می‌کند.\n*   l- یا =level--: سطح RAID را مشخص می‌کند\n*   s- یا scan--: فایل کانفیگ یا فایل proc/mdstat/ را برای یافتن اطلاعات مربوط جستجو می‌کند.\n*   e- یا =metadata--: مدل metadata استفاده شده برای array را مشخص می‌کند. مقدار پیشفرض 1.2 می‌باشد\n*   v- یا verbose—:‌ جهت نمایش اطلاعات بیشتر در رابطه با عملیات در حال انجام استفاده می‌شود.\n\nو …\n\nmdadm دارای گزینه‌های بسیاری است که می‌توانید جهت مطالعه آن‌ها به مستندات Man Pages این برنامه مراجعه کنید\n\n```sh\nman mdadm\n```\n\nبرای ایجاد یک array از نوع raid 1 به‌صورت زیر عمل می‌کنیم.\n\n```sh\nmdadm –create /dev/md0 –level=1 –raid-devices=2 /dev/sda /dev/sdb –spare-devices=1 /dev/sdc\n```\n\nدر اینجا ما یک array از نوع raid 1 یا mirroring با دو دیسک به نام‌های sda و sdb ایجاد نمودیم؛ همچنین یک دیسک sdc را هم به‌عنوان دیسک یدک برای مواقعی که یکی از دیسک های فعال دچار مشکل شد به array اضافه نمودیم.\n\nبرای مشاهده وضعیت array ایجاد شده دستور زیر را وارد می‌کنیم.\n\n```sh\nmdadm –detail /dev/md0\n```\n\nپس از اجرای دستور فوق خروجی زیر را خواهیم داشت.\n\n```\n/dev/md0:\n        Version : 1.2\n  Creation Time : Wed Aug 10 11:36:54 2016\n     Raid Level : raid1\n     Array Size : 8380416 (7.99 GiB 8.58 GB)\n  Used Dev Size : 8380416 (7.99 GiB 8.58 GB)\n   Raid Devices : 2\n  Total Devices : 3\n    Persistence : Superblock is persistent\n\n    Update Time : Wed Aug 10 11:55:45 2016\n          State : clean \n Active Devices : 2\nWorking Devices : 3\n Failed Devices : 0\n  Spare Devices : 1\n\n           Name : debian:0  (local to host debian)\n           UUID : d26d12cf:b0037b53:cfb06317:a06a841b\n         Events : 20\n\n    Number   Major   Minor   RaidDevice State\n       0       8       16        0      active sync   /dev/sda\n       1       8       32        1      active sync   /dev/sdb\n\n       2       8       48        -      spare   /dev/sdc\n```\n\n**نکته: می‌توانیم به‌جای وارد نمودن شماره سطح از عنوان سطح مورد نظر برای گزینه level-- استفاده کنیم.**\n\nبرای مثال دستور زیر یک array از نوع raid 0 یا stripe ایجاد می‌کند.\n\n```sh\nmdadm –create /dev/md0 –level=stripe –raid-devices=2 /dev/sda /dev/sdb\n```\n\nبرای ذخیره تنظیمات به‌صورت زیر عمل می‌کنیم.\n\n```sh\nmdadm –detail –scan /etc/mdadm/mdadm.conf\n```\n\nجهت مشاهده وضعیت array ایجاد شده دستور زیر را وارد \nمی‌کنیم.\n\n```sh\ncat /proc/mdstat\n```\n\nکه در صورت فعال بودن و تعریف نمودن array خروجی زیر را خواهیم داشت.\n\n```\nPersonalities : [raid6] [raid5] [raid4] [raid1] \nmd0 : active raid1 sdc[2](S) sdb[1] sda[0]\n      8380416 blocks super 1.2 [2/2] [UU]\n      \nunused devices: \u003cnone\u003e\n```\n\nسپس می‌توانیم array ایجاد شده را با فرمت فایل سیستم مورد نظرمان توسط دستور mkfs به‌صورت زیر فرمت کنیم.\n\n```sh\nmkfs -t ext4 /dev/md0\n```\n\nو در نهایت array ایجاد شده را ماونت می‌کنیم.\n\n```sh\nmount /dev/md0 /mnt\n```\n\nدر صورتی که بخواهیم array مورد نظر را غیرفعال کنیم دستور زیر را وارد می‌کنیم.\n\n```sh\nmdadm –stop /dev/md0\n```\n\nکه در اینجا md0 غیرفعال گردید و برای فعال نمودن مجدد array به صورت زیر عمل می‌کنیم.\n\n```sh\nmdadm –assemble –scan\n```\n\nبرای حدف یک دیسک از array بصورت زیر عمل می‌کنیم.\n\nابتدا توسط دستور زیر دیسک را به حالت fail تغییر وضعیت می‌دهیم.\n\n```sh\nmdadm /dev/md0 –fail /dev/sdc\n```\n\nسپس دستور زیر را برای حذف دیسک از array وارد می‌کنیم.\n\n```sh\nmdadm /dev/md0 –remove /dev/sdc\n```\n\nو برای اضافه نمودن مجدد یک دیسک به array دستور زیر را وارد می‌کنیم.\n\n```sh\nmdadm /dev/md0 –add /dev/sdc\n```\n"}},"__N_SSG":true},"page":"/articles/[slug]","query":{"slug":"2016-08-11_raid"},"buildId":"igqXl2OPJ05s2tPs4MQMK","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-e893e522365b6e0e5fa4.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.f8bd46fc02868c500bda.js" async=""></script><script src="/_next/static/chunks/dccdaae97238514e0e59f68ff40a3150f2d60869.fd7c33e9ae3c66b740c3.js" async=""></script><script src="/_next/static/chunks/main-3c19994afb449613f52a.js" async=""></script><script src="/_next/static/chunks/c18007ee4e366b206423f37b43f40d4861448257.6ad75590f65d0a64ea61.js" async=""></script><script src="/_next/static/chunks/9f32a1895f4aacf1ea63ff9f71a540b7eb71f721.c3d97f18e04e41235ad9.js" async=""></script><script src="/_next/static/chunks/pages/_app-5e768503c47f0f474cf1.js" async=""></script><script src="/_next/static/chunks/884c0b09aaba7d8da8976f96bae68463b81d3e33.69e17f26dc467dcd1735.js" async=""></script><script src="/_next/static/chunks/755b54d753eea6c310ec0b9a05508d467366a08f.dd8ff6ba50741b700375.js" async=""></script><script src="/_next/static/chunks/6b20a07b2d70cfcb2a9bc7e0210d4109f26bcd0c.6ef66b02a65441044c74.js" async=""></script><script src="/_next/static/chunks/pages/articles/%5Bslug%5D-8dd97a7322e8b3511971.js" async=""></script><script src="/_next/static/igqXl2OPJ05s2tPs4MQMK/_buildManifest.js" async=""></script><script src="/_next/static/igqXl2OPJ05s2tPs4MQMK/_ssgManifest.js" async=""></script></body></html>