---
layout: post
jdate: '1392-11-14'
user: misam
title: آموزش نصب آرچ لینوکس
categories:
- آموزشی
tags:
- آرچ‌لینوکس
featured: arch_linux.jpg
keywords:
- نصب آرچ لینوکس
- arch linux installation
description: آموزش نصب آرچ لینوکس
timeToRead: 5
---

همان‌طور که در مطلب [توزیع آرچ لینوکس](http://linuxihaa.ir/%D8%AA%D9%88%D8%B2%DB%8C%D8%B9-%D8%A2%D8%B1%DA%86-%D9%84%DB%8C%D9%86%D9%88%DA%A9%D8%B3/) مطالعه کردید، توزیع آرچ با هدف سادگی و سبکی آمده است و از این رو به‌صورت پیش‌فرض فرایند نصبی برای آن در نظر گرفته نشده است و اشاره کردیم که آموزش عملیات نصب در آن به صورت کلی و سربسته به صورت فایل متنی قرار داده شده است؛ اما اکنون می‌خواهم فرایند نصب این توزیع را به صورت ساده آموزش بدهم تا کاربرانی که علاقه‌مند به سرعت و سبکی این توزیع هستند بتوانند به‌راحتی از آن استفاده کنند.

قبل از آموزش مراحل نصب دو توزیع آرچ بنگ ([archbang](http://archbang.org/)) و انترگوس ([Antergos](http://antergos.com/)) را به شما معرفی می‌کنم که نصب آرچ لینوکس را برای کاربران راحت کرده‌اند.

آرچ بنگ یک توزیع بر پایه آرچ با مدیر پنجره و میزکار اوپن باکس (Openbox) است که فرایند نصب ساده‌ای را در اختیار شما می‌گذارد.

انترگوس نیز یک توزیع دوست داشتنی بر پایه آرچ است که گزینه‌های نصب پایه، همراه با میزکار سینامون، گنوم، اوپن‌باکس و ... را برای شما محیا می‌کند تا به هر صورت که می‌خواهید و به راحتی هرچه تمام آرچ لینوکس را نصب کند.

اما برویم سر مطلب اصلی خودمان یعنی، آموزش نصب آرچ لینوکس و نه نصب با دیگر توزیع‌ها. این کار ممکن است در نگاه اول سخت به نظر بیاید اما این‌طور نیست و با آموزشی که در ادامه مطالعه می‌کنید بسیار راحت است. همچنین مراحل نصب برای دوست‌داران خط فرمان (بهتر بگویم دوست داران دانستن و به نوعی شاید گیگ ها) بسیار جالب است.

شروع کنیم.

ابتدا آخرین نسخه آرچ لینوکس را از آدرس archlinux.org/download دریافت کنید و دیسک یا فلش قابل بوت خود را آماده کنید.

سپس آرچ را توسط دیسک یا فلش بالا بیاورید و در صفحه‌ای که به شکل زیر می‌بینید یکی از موارد x86_64 و یا i686 را انتخاب کنید و منتظر بمانید تا خط فرمان برای شما آماده شود و بعد از آن مراحل نصب را دنبال کنید.

![](/images/arch-bootloader.png)

## مرحله اول - پارتیشن بندی هارد دیسک در لینوکس

ابتدا دستور زیر را وارد کرده تا از آدرس هارد دیسک خود در میان دستگاه‌های متصل مطلع شوید.

```sh
lsblk
```

در خروجی شما `/dev/sda` را خواهید دید. اکنون برنامه پارتیشن بندی در خط فرمان را با آدرس هارد دیسک را وارد کنید.

```sh
cgdisk /dev/sda
```

اکنون صفحه‌ای مانند تصویر زیر را مشاهده خواهید کرد.

![](/images/cgdisk.jpg)

### ایجاد پارتیشن بوت در لینوکس با برنامه cgdisk

روی گزینه New رفته و مقادیر زیر را در سوالات وارد کنید.

1.  Hit New » چیزی وارد نکنید و اینتر بزنید
2.  First Sector » چیزی وارد نکنید و اینتر بزنید
3.  Size in Sector » مقدار 1007KiB را وارد کنید و اینتر بزنید
4.  Hex Code of GUID (L to show codes, Enter = 8300) » مقدار ef02 را وارد کنید و اینتر بزنید
5.  Enter partition name » چیزی وارد نکنید و اینتر بزنید

اکنون صفحه‌ای مانند تصویر زیر را مشاهده خواهید کرد.

![](/images/cgdisk-bios-partition.jpg)

### ایجاد پارتیشن روت در لینوکس با برنامه cgdisk

مانند بالا عمل کنید فقط در بخش سوم فضای مورد نیازتان برای روت لینوکس مثلا 20GB را وارد کنید و در بخش چهارم نیز چیزی وارد نکنید.

### ایجاد پارتیشن swap در لینوکس با برنامه cgdisk

بخش سواپ در لینوکس برای کمک به حافظه اصلی قرار گرفته است. شما می‌توانید بسته به اندازه رم خود مقدار فضای سواپ مناسب را بسازید. برای این کار مانند مراحل بالا عمل کنید فقط در بخش سوم فضای سواپ مورد نیاز مثلا 2GB را وارد کنید. در بخش چهارم نیز مانند روت چیزی وارد نکنید و در بخش پنجم کلمه swap را وارد کنید.

### ایجاد پارتیشن home در لینوکس با برنامه cgdisk

مانند ساخت پارتیشن روت عمل کنید فقط در بخش سوم فضای مورد نیازتان برای هوم دایرکتوری لینوکس مثلا 50GB را وارد کنید.

در آخر باید صفحه‌ای مانند تصویر زیر را مشاهده کنید.

![](/images/cgdisk-complete-partitions.jpg)

سپس گزینه Write را زده و با وارد کردن yes عمل پارتیشن بندی را کامل کنید و بعد با گزینه Quit از برنامه خارج شوید.

اکنون باز هم دستور `lsblk` را در خط فرمان وارد کنید. اگر پارتیشن بندی درست انجام شده باشد خروجی شبیه به تصویر زیر خواهید داشت.

![](/images/lsblk-arch-linux.jpg)

## مرحله دوم - ساخت فایل سیستم در لینوکس (فرمت کردن پارتیشن ها در لینوکس)

دستورات زیر را وارد کنید تا پارتیشن‌های ۲ و ۴ با فرمت ext4 فرمت شوند.

```sh
mkfs.ext4 /dev/sda2
mkfs.ext4 /dev/sda4
```

سپس دستور زیر را برای ساخت فرمت swap در پارتیشن ۳ وارد کنید.

```sh
mkswap /dev/sda3
```

اکنون پارتیشن سواپ را فعال کنید

```sh
swapon /dev/sda3
```

این مرحله هم تمام شد.

## مرحله سوم - اتصال و استفاده از هارد دیسک پارتیشن بندی شده

ابتدا پارتیشن روت را مانت کنید.

```sh
mount /dev/sda2 /mnt
```

سپس شاخه هوم را ساخته و پارتیشن هوم را نیز روی آن مانت کنید.

```sh
mkdir /mnt/home
mount /dev/sda4 /mnt/home
```

## مرحله چهارم - انتخاب mirror مناسب در آرچ لینوکس

دستور زیر را وارد کنید و از لیست میرورها، میرور مناسب را انتخاب کرده، به اول خط آن رفته، کلید Alt + 6 را فشرده سپس به بالای لیست بروید و کلید Ctrl + U را بزنید تا متن آدرس سرور چسبانده شود. سپس کلید Ctrl + X را فشرده و با وارد کردن کلید Y خارج شوید.

```sh
nano /etc/pacman.d/mirrorlist
```

## مرحله پنجم - نصب بسته های اولیه آرچ لینوکس

ابتدا بهتر است با دستور زیر از اتصال درست به اینترنت مطمئن شوید.

```sh
ping -c 4 linuxihaa.ir
```

سپس دستور زیر را وارد کرده و تا کامل شدن دانلود و نصب بسته‌ها که چیزی حدود ۱۵۰ مگابایت است صبر کنید.

```sh
pacstrap -i /mnt base base-devel
```

## مرحله ششم - کانفیگ fstab در آرچ لینوکس

با دستور زیر fstab را کانفیگ کنید تا مشخصات نصب در سیستم شما کانفیگ شود.

```sh
genfstab -U -p /mnt >> /mnt/etc/fstab
```

برای مشاهده صحت پارتیشن بندی، نصب اولیه آرچ و کانفیگ دستور زیر را وارد کنید. برای خروج نیز مانند بخش انتخاب میرور عمل کنید.

```sh
nano /mnt/etc/fstab
```

## مرحله ششم - وارد شدن به لینوکس نصب شده روی هارد دیسک

با دستور زیر وارد لینوکسی که نصب کرده‌اید بشوید تا آن را کانفیگ کنید.

```sh
arch-chroot /mnt
```

## مرحله هفتم - تنظیم زبان و لوکیشن در آرچ لینوکس

دستور زیر را وارد کنید تا لیست زبان ها را مشاهده کنید و یکی از آن‌ها مثلا en_US.UTF-8 UTF-8 را انتخاب کرده و کامنت اول آن را بردارید و از ویراشگر nano خارج شوید و در هنگام خروج تغییرات را ذخیره کنید.

```sh
nano /etc/locale.gen
```

سپس دستورات زیر را وارد کنید.

```sh
locale-gen
echo LANG=en_US.UTF-8 > /etc/locale.conf
export LANG=en_US.UTF-8
```

### تنظیم Time zone در آرچ لینوکس

دستور زیر را وارد کنید تا محل مورد نظر خود را از لیست موجود بیابید.

```sh
ls /usr/share/zoneinfo/
```

سپس از دستور زیر برای تنظیم تایم زون استفاده کنید. توجه کنید که این بخش را بسته به محل خودتان تنظیم کنید.

```sh
ln -s /usr/share/zoneinfo/<Zone>/<SubZone> /etc/localtime
```

مثلا من تهران، آسیا را انتخاب کردم از دستور زیر استفاده کردم.

```sh
ln -s /usr/share/zoneinfo/Asia/Tehran> /etc/localtime
```

سپس دستور زیر را برای تنظیم ساعت سیستم وارد کنید. در اینجا من UTC را انتخاب کردم.

```sh
hwclock --systohc --utc
```

## مرحله هشتم - تنظیم نام کامپیوتر در آرچ لینوکس

در این مرحله نام هاست خود را ست می‌کنیم. مثلا من linuxihaa را با دستور زیر انتخاب کرده‌ام.

```sh
echo muktware > /etc/hostname
```

## مرحله نهم - کانفیگ و تنظیمات مخازن در آرچ لینوکس

دستور زیر را وارد کنید وارد کنید.

```sh
nano /etc/pacman.conf
```

و اگر از نسخه ۶۴ بیت استفاده می‌کنید کامنت منابع مالتی لیب که متن آن مانند زیر است را بردارید و از ویراشگر خارج شده و تغییرات را ذخیره کنید.

```
[multilib]
Include = /etc/pacman.d/mirrorlist
```

سپس با دستور زیر منابع را به روز کنید.

```sh
pacman -Sy
```

## مرحله دهم - ساخت کاربر در آرچ لینوکس

ابتدا با دستور زیر رمز مناسبی برای کاربری روت خود تنظیم کنید.

```sh
passwd
```

سپس کاربری مانند linuxihaa و یا هر نام دیگری که می‌خواهید را با دستور زیر به آرچ لینوکس اضافه کنید (دستور زیر کاربر شما را در گروه wheel نیز قرار می‌دهد).

```sh
useradd -m -g users -G wheel,storage,power -s /bin/bash linuxihaa
```

بعد از آن با دستور `passwd linuxihaa` گذرواژه مناسب را برای کاربر خود انتخاب کنید.

## مرحله یازدهم - نصب و تنظیمات sudo در آرچ لینوکس

ابتدا با دستورات زیر برنامه sudo را به صورت کامل نصب کنید.

```sh
pacman -S sudo
pacman -Ss sudo
```

### اجازه دادن به کاربران گروه wheel برای اجرای sudo در آرچ لینوکس

دستور زیر را وارد کرده و کامنت خط حاوی `%wheel ALL=(ALL) ALL` را بردارید و از ویرایشگر خارج شده و تغییرات را ذخیره کنید.

```sh
EDITOR=nano visudo
```

## مرحله دوازدهم - نصب و bash-completion برای کامل کردن اتوماتیک نام دستورات بسته ها

دستور زیر را اجرا کنید.

```sh
pacman -S bash-completion
```

## مرحله سیزدهم - نصب بوت لودر Grub روی ارچ لینوکس

ابتدا دستور زیر را برای نصب بسته بوت لودر گراب وارد کنید.

```sh
pacman -S grub
```

اکنون گراب را روی هارد دیسک خود نصب کنید.

```sh
grub-install --target=i386-pc --recheck /dev/sda
```

برای کانفیگ گراب و اضافه کردن دیگر سیستم عامل های نصب شده روی سیستم خود به منوی گراب دستور زیر را وارد کنید.

```sh
grub-mkconfig -o /boot/grub/grub.cfg
```

## مرحله پایانی

از لینوکس نصب شده خارج شوید.

```sh
exit
```

سپس پارتیشن روت را از مانت خارج کنید.

```sh
umount -R /mnt
```

و در آخر سیستم را دوباره راه اندازی کنید.

```sh
reboot
```

تبریک! تمام شد و بعد از بالا آمدن گراب می‌توانید وارد آرچ لینوکس نصب شده خود شوید.

به زودی آموزش نصب محیط گرافیکی شامل میزکار در آرچ لینوکس را هم در همین سایت خواهم گذاشت. موفق باشید.

* منبع goo.gl/HTpax1