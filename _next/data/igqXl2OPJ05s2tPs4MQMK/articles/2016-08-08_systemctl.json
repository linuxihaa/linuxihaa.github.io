{"pageProps":{"page":{"slug":"2016-08-08_systemctl","layout":"post","jdate":"Mon Aug 08 2016 00:00:00 GMT+0000","user":"farbodgame","title":"مدیریت سرویس‌ها توسط systemctl","categories":["آموزشی"],"tags":["پیکربندی"],"featured":"systemctl.jpg","keywords":["systemctl","systemd"],"description":"مدیریت سرویس‌ها توسط systemctl","timeToRead":5,"content":"\nدر این مطلب قصد داریم دستورات systemctl را آموزش بدهیم که ابزار اصلی برای کنترل سرویس‌ها و init است. در ادامه نگاهی می‌اندازیم که چگونه سرویس‌ها را مدیریت کنیم و در نهایت وضعیتشان را بررسی کنیم.\n\n## شروع و متوقف کردن سرویس‌ها\n\nبرای شروع کردن یک سرویس systemd باید از دستور `start` \nاستفاده کنیم.\n\nاگر شما یک کاربر غیر ریشه هستید لطفا روت شوید و یا قبل از دستور `sudo` بگذارید تا دستور با دسترسی ریشه اجرا شود در غیر این صورت ممکن که دستور شما عمل نکند.\n\n```sh\nsystemctl start APPLICATION.service\n```\n\nتوسط این دستور شما می‌توانید سرویس خود را شروع کنید.\n\n برای مثال توسط این دستور میتوانید وب سرور nginx را فعال نمایید (لازم به ذکر است که اگر شما نام سرویسی را که می‌خواهید استفاده کنید را نمی‌دانید، می‌توانید با نوشتن فقط یکی دو حرف اول آن سرویس و سپس زدن دو بار پشت سر هم کلید `TAB` نام آن را کامل کنید.).\n \n```sh\nsystemctl start nginx.service\n```\n\nsystemd برای کنترل کردن یک سرویس، به دنبال `*.service` (همانطور که می‌دانید ستاره یک `wild card` و به معنی هر چیزی است) می‌گردد، بنابر این شما می‌توانید برای راحتی کار به این صورت سرویس‌های خود را مدیریت کنید.\n\n```sh\nsystemctl start nginx\n```\n\nدرصورتی که می‌خواهید سرویسی را که شروع کرده‌اید، متوقف \nکنید می‌توانید به همین شیوه عمل کنید با این تفاوت که به جای `start` از `stop` استفاده کنید.\n\n```sh\nsystemctl stop APPLICATION.service\n```\n\n## بارگذاری و راه اندازی مجدد سرویس‌ها\n\nدر صورتی که سرویسی را شروع کردید و اکنون می‌خواهید آن را دوباره راه‌اندازی کنید باید از `restart` استفاده کنید.\n\n```sh\nsystemctl restart APPLICATION.service\n```\n\nو یا اگر می‌خواهید فقط آن را به صورت مجدد بارگذاری نمایید میتوانید از `reload` استفاده کنید.\n\n```sh\nsystemctl reload APPLICATION.service\n```\n\n **​نکته:** تفاوت `reload` و `restart` در این است که `reload` فقط فایل کانفیگ ویرایش شده را می‌خواند (و سرویس را مجدد راه‌اندازی نمی‌کند) که عموما بسیار سریع انجام می‌شود. اما اگر می‌خواهید به‌طور کلی یک سرویس را دوباره راه‌اندازی کنید باید از `restart` استفاده کنید که عموما زمان بیشتری نسبت به بارگذاری طول می‌کشد. اگر مطمئن نیستید که می‌خواهید از کدام استفاده کنید بهتر است که از `reload-or-restart` استفاده کنید که ابتدا فایل کانفیگ ویرایش شده را مجدد بارگذاری می‌کند و در صورت نیاز سرویس مربوطه را مجدد راه اندازی می‌کند.\n\n```sh\nsystemctl reload-or-restart APPLICATION.service\n```\n\n## فعال و غیر فعال کردن سرویس‌ها\n\nدر صورتی که سرویس مورد نظر خود را توسط `start` شروع کرده باشید، با اولین ریبوت همه آنها به تنظیمات خود بازمی‌گردد و ممکن است اصلا بعد از بارگذاری سیستم اجرا نشوند. در صورتی که می‌خواهید systemd سرویس مورد نظر شما را هنگام بوت به صورت خودکار فعال کند باید از enable استفاده کنید. به این صورت.\n\n```sh\nsystemctl enable APPLICATION.service\n```\n\nاین کار یک لینک از `/etc/systemd/system` (و در بعضی سیستم ها `/lib/systemd/system`) ایجاد می‌کند در مسیری که systemd در آن به دنیال فایل هایی می‌گردد که باید هنگام بوت آنها را شروع کند. (معمولا در `/etc/systemd/system/some-target.target.wants​_`)\n\nاگر می‌خواهید عکس این کار را انجام دهید، یعنی وقتی سیستم بوت شد آن سرویس به طور پیشفرض اجرا نشود باید از `disable` استفاده کنید، به این صورت.\n\n```sh\nsystemctl disable APPLICATION.service\n```\n\nبرای مثال درصورتی که می‌خواهید جلوی اجرا شدن خودکار وب سرور nginx را هنگام بوت بگیرید باید به این صورت عمل کنید.\n\n```sh\nsystemctl disable nginx.service\n```\n\n## وضعیت یک سرویس\n\nدر صورتی که می‌خواهید وضعیت یک سرویس را بررسی کنید (برای مثال مطمئن شوید که سرویس شروع و یا متوقف شده است و یا چند خط اول لاگ را بررسی کنید) میتوانید از `status` استفاده نمایید.\n\n\n```sh\nsystemctl status APPLICATION.service\n```\n\nبرای مثال، در صورتی که وضعیت وب سرور nginx را بررسید کنید با خطوطی شبیه به این مواجه می‌شوید:\n\n```\nnginx.service - A high performance web server and a reverse proxy server\nLoaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)\nActive: active (running) since Tue 2015-01-27 19:41:23 EST; 22h ago Main PID: 495 (nginx)\nCGroup: /system.slice/nginx.service\n├─495 nginx: master process /usr/bin/nginx -g pid /run/nginx.pid; error_log stderr;\n└─496 nginx: worker processJan 27 19:41:23 desktop systemd[1]: Starting A high performance web server and a reverse proxy server...Jan 27 19:41:23 desktop systemd[1]: Started A high performance web server and a reverse proxy server.\n```\n\nاگر می‌خواهید مطمئن شوید سرویسی که می‌خواهید شروع یا متوقف شده است (برای مثال در اسکریپت نویسی) می‌توانید از `is-active` استفاده کنید.\n\n```sh\nsystemctl is-active APPLICATION.service\n```\n\nخروجی این دستور در صورتی که سرویس مورد نظر شما شروع شده باشد `active` خواهد بود و در غیر این صورت `inactive`.\n\nو به همین ترتیب، اگر می‌خواهید مطمئن شوید که سرویس شما فعال است یا غیر فعال (الان شما دیگه می‌دونید که فرق غیر فعال با متوقف چیه :) ) می‌توانید از `is-enabled` استفاده کنید.\n\n```sh\nsystemctl is-enabled APPLICATION.service\n```\n\nخروجی این دستور هم در صورت فعال بودن `enable` و در صورت غیر فعال بودن `disable` خواهد بود.\n\nمنبع با اندکی تغییر:\n[How To Use Systemctl to Manage Systemd Services and Units](https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units)\n"}},"__N_SSG":true}