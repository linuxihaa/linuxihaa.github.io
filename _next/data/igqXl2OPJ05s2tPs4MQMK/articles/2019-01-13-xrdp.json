{"pageProps":{"page":{"slug":"2019-01-13-xrdp","layout":"post","jdate":"Sun Jan 13 2019 00:00:00 GMT+0000","user":"rmasoumvand","title":"ریموت دسکتاپ در لینوکس با xrdp","categories":["آموزشی"],"tags":["شبکه","سرور"],"featured":"xrdp-linux-desktop-remote-rdp.png","keywords":["ریموت دسکتاپ در لینوکس","rdp","remote desktop in linux"],"description":"آموزش ریموت دسکتاپ در لینوکس با xrdp","timeToRead":5,"content":"\nاگر با سیستم‌های ویندوزی کار کرده باشید حتما می‌دانید که تمامی نسخه‌های ویندوز قابلیت اختصاصی به نام Remote Desktop یاRDP دارند که بوسیله این قابلیت می‌توانید به‌صورت ریموت به صفحه دسکتاپ خود دسترسی داشته باشید.\nاما در سیستم‌های شبهه یونیکس به‌دلیل این‌که اغلب تنظیمات به‌صورت متنی انجام می‌شود، معمولا کاربران توسظ SSH می‌توانند به سیستم راه دور خود متصل شوند و کار خود را انجام دهند. \nحتما تا به حال برای شما پیش امده است که بخواهید در محیط شبکه از سیستم ویندوزی خود به صفحه دسکتاپ لینوکس خود به‌صورت ریموت دسترسی داشته باشید. اما همانطور که می دانید برخلاف ویندوز در سیستم عامل لینوکس به‌صورت پیش‌فرض از RDP پشتیبانی نمی‌شود ولی خوشبختانه توسط ابزاری به نام Xrdp این امکان در لینوکس نیز میسر می‌شود که در این مقاله به نصب و پیکربندی ان خواهیم پرداخت\n\nپروژه Xrdp یک ابزار متن‌باز است که این امکان را به کاربران می‌دهد که بتوانند به دسکتاپ لینوکس خود از داخل سیستم عامل ویندوز دسترسی داشته باشند. این ابزار علاوه بر پشتیبانی از RDP Client های ویندوزی از سایرکلاینت‌های مشابه همچون FreeRDP, rdesktop, NeutrinoRDP نیز پشتیبانی می‌کند. همچنین در نسخه جدید این برنامه برای امنیت بیشتر از TLS نیز پشتیبانی می‌گردد.\n\nبرای نصب در سیستم‌های مبتنی بر Debian دستور زیر را وارد می‌کنیم:\n\n```sh\napt install xrdp\n```\n\nبرای نصب در سیستم‌های مبتنی بر Redhat دستورات زیر را وارد می‌کنیم:\n\n```sh\nrpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nyum update && yum -y install xrdp tigervnc-server\n```\n\nسپس فایل زیر را ویرایش می‌کنیم\n\n\n```\nnano /etc/polkit-1/localauthority.conf.d/02-allow-colord.conf \n```\n\nو مانند زیر آن را تغییر می‌دهیم\n\n```shell\npolkit.addRule(function(action, subject) {\n   if ((action.id == “org.freedesktop.color-manager.create-device” || action.id == “org.freedesktop.color-manager.create-profile” || action.id == “org.  freedesktop.color-manager.delete-device” || action.id == “org.freedesktop.color-manager.delete-profile” || action.id == “org.freedesktop.color-manager. modify-device” || action.id == “org.freedesktop.color-manager.modify-profile”) && subject.isInGroup(“{group}”))\n   {\n      return polkit.Result.YES;\n   }\n});\n```\n\nو سپس سرویس xrdp را توسط دستور زیر restart می‌کنیم\n\n```sh\nsystemctl restart xrdp\n```\n\nبرای بررسی وضعیت xrdp می‌توانیم دستور زیر را بزنیم\n\n```sh\nsystemctl status xrdp\n```\n\nکه در صورتی که سرویس xrdp بدون مشکل و در حال اجرا باشد خروجی زیر را خواهیم دید\n\n```\n● xrdp.service - xrdp daemon\n   Loaded: loaded (/lib/systemd/system/xrdp.service; enabled; vendor preset: en\n   Active: active (running) since Tue 2018-10-16 02:05:21 WAT; 11min ago\n     Docs: man:xrdp(8)\n           man:xrdp.ini(5)\n Main PID: 2654 (xrdp)\n    Tasks: 1 (limit: 2290)\n   CGroup: /system.slice/xrdp.service\n           └─2654 /usr/sbin/xrdp\n```\n\nاگر بخواهیم با هر بار راه‌اندازی سیستم سرویس xrdp هم به‌صورت خودکار اجرا شود، دستور زیر را وارد می‌کنیم\n\n```sh\nsystemctl enable xrdp\n```\n\nسرویس xrdp روی پورت 3389 کار می‌کند. پس برای این‌که بتوانیم به‌صورت ریموت به سیستم دسترسی داشته باشیم لازم است در فایروال سیستمی که xrdp روی ان نصب است پورت tcp/3389 را ازاد کنیم\n\nدر صورتی که از ufw برای مدیریت فایروال استفاده می‌کنید، می‌توانید دستور زیر را جهت ازاد شدن پورت tcp/3389 وارد کنید\n\n```sh\nufw allow 3389/tcp\n```\n\nدر صورتی که از firewalld برای مدیریت فایروال استفاده می‌کنید دستور زیر را جهت ازاد شدن پورت tcp/3389 وارد کنید\n\n```sh\nfirewall-cmd --permanent --zone=public --add-port=3389/tcp\nfirewall-cmd --reload\n```\n\nحال می‌توانید از سیستم ویندوز به دسکتاپ لینوکس خود دسترسی داشته باشید.\nبرای این منظور در سیستم‌عامل ویندوز ابزار Remote Desktop Connection را اجرا می‌کنیم\n\n![IMAGE_TITLE](/images/xrdp/01-rdp-win-tools.png)\n\nادرس IP سیستم مقابل و Username را مانند شکل زیر وارد می‌کنیم\n\n![IMAGE_TITLE](/images/xrdp/02-rdp-win-connection.png)\n\nو سپس روی connect کلیک می‌نماییم\n\n![IMAGE_TITLE](/images/xrdp/03-rdp-win-confirm.png)\n\nپس از برقراری اتصال، کادر زیر نمایش داده خواهد شد که از شما نام کاربری و کلمه عبور را درخواست می‌کند. آن را وارد نموده و روی OK کلیک می‌کنیم.\n\n![IMAGE_TITLE](/images/xrdp/04-rdp-win-credential-login.png)\n\nدر صورتی که نام کاربری و رمز عبورتان صحیح باشد با صفحه لاگین مواجه خواهید شد که می‌توانید رمز عبورتان را وارد کنید و وارد دسکتاپ لینوکستان شوید.\n\n![IMAGE_TITLE](/images/xrdp/05-rdp-win-ubuntu-connection-ok.jpg)\n"}},"__N_SSG":true}